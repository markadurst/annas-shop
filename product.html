<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Anna's Sweet Crafts</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Comic+Neue:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="images/logo.jpg" alt="Anna's Sweet Crafts Logo" class="logo-img">
                <h1>Anna's Sweet Crafts</h1>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="index.html#products" class="nav-link">Products</a>
                <a href="index.html#about" class="nav-link">About</a>
                <a href="index.html#contact" class="nav-link">Contact</a>
            </nav>
            <div class="cart-icon" onclick="toggleCart()">
                <span class="cart-icon-emoji">üõí</span>
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </div>
    </header>

    <!-- Product Detail Section -->
    <section class="product-page">
        <div class="container">
            <a href="index.html" class="back-to-shop">‚Üê Back to Shop</a>
            
            <div class="product-detail" id="productDetail">
                <p>Loading product details...</p>
                <!-- Product details will be dynamically loaded here -->
            </div>
        </div>
    </section>

    <!-- Shopping Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Your Cart üõí</h3>
            <button class="close-cart" onclick="toggleCart()">√ó</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be dynamically loaded here -->
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <strong>Total: $<span id="cartTotal">0.00</span></strong>
            </div>
            <button class="checkout-btn" onclick="goToCheckout()">Checkout</button>
        </div>
    </div>

    <!-- Cart Overlay -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Anna's Sweet Crafts. Made with üíï for friends everywhere!</p>
        </div>
    </footer>

    <script>
        // Product data (same as in script.js)
        const products = [
            // Friendship Bracelets
            {
                id: 1,
                name: "Friendship Bracelet",
                category: "bracelets",
                price: 3.00,
                image: "images/all_bracelets.jpeg",
                description: "Beautiful handmade friendship bracelets made with love. Perfect for sharing with your best friend! Choose from 7 vibrant colors. Each bracelet is carefully handcrafted using high-quality cotton thread and features a classic friendship bracelet pattern that will last for years to come.",
                colors: [
                    "Pink",
                    "Blue", 
                    "Green",
                    "Purple",
                    "Orange",
                    "Yellow",
                    "Black"
                ],
                materials: "High-quality cotton thread",
                care: "Hand wash gently with mild soap and air dry"
            },
            // Keychain Holders
            {
                id: 8,
                name: "Keychain Holder",
                category: "keychains",
                price: 5.00,
                image: "images/keychains.jpg",
                description: "A stylish keychain holder that keeps your keys organized and adds personality to your bag! Choose from 9 fun designs. This holder is perfect for keeping your keys safe and easy to find.",
                designs: [
                    "Cat Party",
                    "Noir Owl", 
                    "Midnight Llama",
                    "Love Birds",
                    "Elephant Parade",
                    "Sloth Party",
                    "Dog Party",
                    "Wild Jungle",
                    "Neon Shark"
                ],
                materials: "Soft fabric with metal ring",
                care: "Spot clean with damp cloth"
            },
            // Pot Holders
            {
                id: 9,
                name: "Pot Holder",
                category: "pot-holders",
                price: 8.00,
                image: "images/potHolders.jpg",
                description: "Beautiful handmade pot holders to protect your hands while cooking! Choose from 6 charming designs. Perfect for any kitchen and makes a great gift! Each pot holder is carefully crafted with heat-resistant padding to keep your hands safe.",
                designs: [
                    "Blue and Yellow Fun",
                    "Pink and White Fun",
                    "Pink Orange Yellow and Green Fun",
                    "Halloween",
                    "Black Yellow Purple Pink White Blue Pattern 1",
                    "Black Yellow Purple Pink White Blue Pattern 2"
                ],
                materials: "High-quality cotton fabric with heat-resistant padding",
                care: "Machine wash gentle cycle, air dry"
            }
        ];

        // Get product ID from URL parameters
        function getProductIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return parseInt(urlParams.get('id'));
        }

        // Display product details
        function displayProductDetails() {
            const productId = getProductIdFromUrl();
            console.log('Product ID from URL:', productId);
            const product = products.find(p => p.id === productId);
            console.log('Found product:', product);
            
            if (!product) {
                document.getElementById('productDetail').innerHTML = '<h1>Product not found</h1>';
                return;
            }

            document.title = `${product.name} - Anna's Sweet Crafts`;
            
            document.getElementById('productDetail').innerHTML = `
                <img src="${product.image}" alt="${product.name}" class="product-detail-image">
                <div class="product-detail-info">
                    <h1>${product.name}</h1>
                    <div class="product-detail-price">$${product.price.toFixed(2)}</div>
                    <div class="product-detail-description">
                        <p>${product.description}</p>
                    </div>
                    
                    <div class="product-specs">
                        <h3>Product Details</h3>
                        ${product.colors ? `<p><strong>Colors:</strong> ${product.colors.join(', ')}</p>` : ''}
                        ${product.designs ? `<p><strong>Available Designs:</strong> ${product.designs.join(', ')}</p>` : ''}
                        <p><strong>Materials:</strong> ${product.materials}</p>
                        <p><strong>Care Instructions:</strong> ${product.care}</p>
                    </div>
                    
                    ${product.designs ? `
                    <div class="design-selector">
                        <label for="design">Choose Design:</label>
                        <select id="design">
                            ${product.designs.map(design => `<option value="${design}">${design}</option>`).join('')}
                        </select>
                    </div>
                    ` : ''}
                    
                    ${product.colors && product.colors.length > 1 ? `
                    <div class="color-selector">
                        <label for="color">Choose Color:</label>
                        <select id="color">
                            ${product.colors.map(color => `<option value="${color}">${color}</option>`).join('')}
                        </select>
                    </div>
                    ` : ''}
                    
                    <div class="quantity-selector">
                        <label for="quantity">Quantity:</label>
                        <select id="quantity">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </div>
                    
                    <button class="add-to-cart-btn" onclick="addToCartWithQuantity(${product.id})">
                        Add to Cart üõí
                    </button>
                </div>
            `;
        }

        // Add to cart with selected quantity
        function addToCartWithQuantity(productId) {
            const quantity = parseInt(document.getElementById('quantity').value);
            const product = products.find(p => p.id === productId);
            
            if (!product) return;

            // Get selected design if it's a keychain holder
            let selectedDesign = null;
            if (product.designs) {
                const designSelect = document.getElementById('design');
                selectedDesign = designSelect ? designSelect.value : product.designs[0];
            }

            // Get selected color if it's a bracelet with multiple colors
            let selectedColor = null;
            if (product.colors && product.colors.length > 1) {
                const colorSelect = document.getElementById('color');
                selectedColor = colorSelect ? colorSelect.value : product.colors[0];
            }

            // Get cart from localStorage or initialize empty array
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            // Create unique key for cart item (productId + design/color)
            let cartKey = productId;
            if (selectedDesign) {
                cartKey = `${productId}-${selectedDesign}`;
            } else if (selectedColor) {
                cartKey = `${productId}-${selectedColor}`;
            }
            
            const existingItem = cart.find(item => {
                const itemKey = item.selectedDesign ? `${item.id}-${item.selectedDesign}` : 
                               item.selectedColor ? `${item.id}-${item.selectedColor}` : item.id;
                return itemKey === cartKey;
            });

            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                const cartItem = {
                    ...product,
                    quantity: quantity
                };
                
                // Add design info if it's a keychain holder
                if (selectedDesign) {
                    cartItem.selectedDesign = selectedDesign;
                    cartItem.displayName = `${product.name} - ${selectedDesign}`;
                }
                
                // Add color info if it's a bracelet with multiple colors
                if (selectedColor) {
                    cartItem.selectedColor = selectedColor;
                    cartItem.displayName = `${product.name} - ${selectedColor}`;
                }
                
                cart.push(cartItem);
            }

            // Save cart to localStorage
            localStorage.setItem('cart', JSON.stringify(cart));
            
            // Update cart display if function exists
            if (typeof updateCartDisplay === 'function') {
            updateCartDisplay();
            }
            
            // Show success message
            const itemName = selectedDesign ? `${product.name} - ${selectedDesign}` : 
                           selectedColor ? `${product.name} - ${selectedColor}` : product.name;
            alert(`Added ${quantity} ${itemName}${quantity > 1 ? 's' : ''} to your cart! üíï`);
        }

        // Cart functionality for product page
        function updateCartDisplay() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            if (!cartCount || !cartItems || !cartTotal) return;
            
            // Get cart from localStorage
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            
            // Update cart count
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;

            // Update cart items
            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align: center; color: #666; padding: 2rem;">Your cart is empty! Add some cute crafts! üíï</p>';
            } else {
                cartItems.innerHTML = cart.map(item => {
                    const itemKey = item.selectedDesign ? `${item.id}-${item.selectedDesign}` : 
                                   item.selectedColor ? `${item.id}-${item.selectedColor}` : item.id;
                    return `
                    <div class="cart-item">
                        <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <div class="cart-item-title">${item.displayName || item.name}</div>
                            ${item.selectedDesign ? `<div class="cart-item-design">Design: ${item.selectedDesign}</div>` : ''}
                            ${item.selectedColor ? `<div class="cart-item-color">Color: ${item.selectedColor}</div>` : ''}
                            <div class="cart-item-price">$${item.price.toFixed(2)}</div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn" onclick="updateQuantity('${itemKey}', -1)">-</button>
                                <span>${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity('${itemKey}', 1)">+</button>
                            </div>
                            <button class="remove-item" onclick="removeFromCart('${itemKey}')">Remove</button>
                        </div>
                    </div>
                `;
                }).join('');
            }

            // Update total
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartTotal.textContent = total.toFixed(2);
        }

        function toggleCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            const cartOverlay = document.getElementById('cartOverlay');
            
            if (!cartSidebar || !cartOverlay) return;
            
            cartSidebar.classList.toggle('open');
            cartOverlay.classList.toggle('show');
            document.body.style.overflow = cartSidebar.classList.contains('open') ? 'hidden' : 'auto';
        }

        function updateQuantity(cartKey, change) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const item = cart.find(item => {
                const itemKey = item.selectedDesign ? `${item.id}-${item.selectedDesign}` : 
                               item.selectedColor ? `${item.id}-${item.selectedColor}` : item.id;
                return itemKey === cartKey;
            });
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    cart.splice(cart.indexOf(item), 1);
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartDisplay();
            }
        }

        function removeFromCart(cartKey) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const newCart = cart.filter(item => {
                const itemKey = item.selectedDesign ? `${item.id}-${item.selectedDesign}` : 
                               item.selectedColor ? `${item.id}-${item.selectedColor}` : item.id;
                return itemKey !== cartKey;
            });
            localStorage.setItem('cart', JSON.stringify(newCart));
            updateCartDisplay();
        }

        function goToCheckout() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length === 0) {
                alert('Your cart is empty! Add some items first! üíï');
                return;
            }
            window.location.href = 'checkout.html';
        }

        // Initialize product page when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing product page');
            displayProductDetails();
            updateCartDisplay();
        });
    </script>
    <script src="script.js"></script>
</body>
</html>
